server.port=${SERVER_PORT:8082}

# JWT issuer - MUST match exactly what Keycloak puts in tokens (including port!)
spring.security.oauth2.resourceserver.jwt.issuer-uri=https://auth.keycloak-demo.local:443/realms/myrealm
# But JWK Set is fetched from internal Keycloak service (backend can't reach external hostname)
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://keycloak:8080/realms/myrealm/protocol/openid-connect/certs

# PostgreSQL Database Configuration
spring.datasource.url=jdbc:postgresql://${DATABASE_HOST:host.docker.internal}:${DATABASE_PORT:5432}/${DATABASE_NAME:nirvana_db}
spring.datasource.username=${DATABASE_USER:postgres}
spring.datasource.password=${DATABASE_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.database-platform=org.hibernate.dialect.PostgreSQL10Dialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true

# Disable Flyway
spring.flyway.enabled=false

# Actuator endpoints
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
# Allow unauthenticated access to health endpoint for Docker healthchecks
management.endpoint.health.probes.enabled=true
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true

# Connection pool
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# Logging
logging.level.root=INFO
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.oauth2=DEBUG
logging.level.org.springframework.security.oauth2.jwt=TRACE
logging.level.org.springframework.security.oauth2.server=TRACE
